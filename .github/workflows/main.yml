# Name des Workflows, der in der GitHub Actions-Oberfläche angezeigt wird
name: Build Flutter Android APK

# Legt fest, wann dieser Workflow ausgeführt wird
on:
  # Löst den Workflow bei jedem Push auf den main-Branch aus
  push:
    branches:
      - main
  # Ermöglicht das manuelle Starten des Workflows über die GitHub Actions-Oberfläche
  workflow_dispatch:

# Definiert die Aufgaben (Jobs), die im Workflow ausgeführt werden
jobs:
  build:
    # Der Typ des Runners, auf dem der Job ausgeführt wird
    runs-on: ubuntu-latest

    # Die einzelnen Schritte des Jobs
    steps:
      # Schritt 1: Das Repository auschecken
      # Lädt den Code deines Repositories auf den Runner herunter
      - name: Checkout repository
        uses: actions/checkout@v4

      # Schritt 2: Flutter SDK einrichten
      # Installiert und konfiguriert das Flutter SDK auf dem Runner
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          # Du kannst hier eine spezifische Flutter-Version angeben, falls nötig
          flutter-version: '3.x' 
          channel: 'stable'
          cache: true # Aktiviert das Caching zur Beschleunigung zukünftiger Builds

      # Schritt 3: Flutter-Abhängigkeiten installieren
      # Führt 'flutter pub get' aus, um alle im pubspec.yaml definierten Pakete herunterzuladen
      - name: Install dependencies
        run: flutter pub get

      # Schritt 4: Die Android APK erstellen
      # Baut die Release-Version der APK. Das Ergebnis wird im Verzeichnis build/app/outputs/flutter-apk/app-release.apk gespeichert
      - name: Build APK
        run: flutter build apk --release

      # Schritt 5: Die erstellte APK als Artefakt hochladen
      # Lädt die generierte APK-Datei hoch, damit du sie nach Abschluss des Workflows herunterladen kannst
      - name: Upload APK artifact
        uses: actions/upload-artifact@v4
        with:
          name: release-apk
          path: build/app/outputs/flutter-apk/app-release.apk
          
